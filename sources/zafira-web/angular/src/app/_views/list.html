<div class="page page-profile" ng-controller="ViewController">

    <div class="row ui-section">
        <div class="col-lg-12">
            <h2 class="section-header"><i class="fa fa-play-circle fa-fw"></i> {{view.name}}</h2>
        </div>
        <md-fab-speed-dial id="main-fab" md-direction="up" class="md-scale md-fab-bottom-right">
            <md-fab-trigger>
                <md-button aria-label="menu" class="md-fab md-primary" md-visible="tooltipVisible">
                    <span class="fa fa-bars" aria-hidden="true"></span>
                </md-button>
            </md-fab-trigger>
            <md-fab-actions>
                <md-button data-ng-if="jenkinsEnabled" aria-label="menu" class="md-fab md-raised md-fab-sm" data-ng-click="rebuildJobs()">
                    <span class="fa fa-refresh" aria-hidden="true"></span>
                </md-button>
                <md-button aria-label="menu" class="md-fab md-raised md-fab-sm" data-ng-click="showJobsViewDialog($event)">
                    <span class="fa fa-plus" aria-hidden="true"></span>
                </md-button>
            </md-fab-actions>
        </md-fab-speed-dial>
        <div class="run_result row" align="center" data-ng-if="! jobViews.length">
            <div class="col-lg-12">No job views available</div>
        </div>
        <div class="row">
            <div class="col-lg-{{envJobViews[0].size}}" data-ng-repeat="(env, envJobViews) in jobViews">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        {{env}} <span data-ng-if="jenkinsEnabled"><a href="" data-ng-click="selectForRerun(env, 'All')">All</a> | <a href="" data-ng-click="selectForRerun(env, 'None')">None</a> | <a href="" data-ng-click="selectForRerun(env, 'Failed')">Failed</a></span>
                            <i class="float_right fa fa-lg fa-gear pointer"
                               style="line-height: 20px;"
                               data-ng-click="showJobsViewDialog($event, envJobViews)"></i>
                    </div>
                    <div class="panel-body">
                        <div class="run_result row result_{{jobView.testRun.status}}" data-ng-class="{'result_UNKNOWN' : jobView.testRun == null}" data-ng-repeat="jobView in envJobViews | orderBy:'job.name'" context-menu="userMenuOptions">
                            <div class="col-lg-6">
                                <input type="checkbox"
                                       data-ng-model="jobView.testRun.rebuild"
                                       data-ng-if="jobView.testRun != null && jobView.testRun.status != 'IN_PROGRESS' && jenkinsEnabled"
                                       data-ng-true-value="true"
                                       data-ng-false-value="false"
                                       id="{{jobView.testRun.id}}"
                                       value="{{jobView.testRun.id}}"
                                       name="{{jobView.testRun.id}}">
                               <!-- <img src="/resources/img/pending.gif" class="pending" data-ng-if="jobView.testRun.status == 'IN_PROGRESS'"/>-->
                                <a href="{{jobView.job.jobURL + '/' + jobView.testRun.buildNumber}}" target="_blank">{{UtilService.truncate(jobView.job.name, 35)}}</a>
                            </div>
                            <div class="col-lg-3" align="center">
                                <time data-ng-if="jobView.testRun.startedAt" am-time-ago="jobView.testRun.startedAt" title="{{ main.time | amDateFormat: 'dddd, MMMM Do YYYY, h:mm a' }}"></time>
                                <span data-ng-if="!jobView.testRun.startedAt">Long ago</span>
                            </div>
                            <div class="col-lg-3" align="right">
                                <span class="label arrowed arrowed-in-right label-success-border" data-ng-class="{'label-success-empty': jobView.testRun.passed == 0, 'label-success': jobView.testRun.passed > 0}">{{jobView.testRun.passed}}</span>
                                <span class="label arrowed arrowed-in-right label-danger-border" data-ng-class="{'label-danger-empty': jobView.testRun.failed == 0, 'label-danger': jobView.testRun.failed > 0}">{{jobView.testRun.failed}}</span>
                                <span class="label arrowed arrowed-in-right label-warning-border" data-ng-class="{'label-warning-empty': jobView.testRun.skipped == 0, 'label-warning': jobView.testRun.skipped > 0}">{{jobView.testRun.skipped}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
